var P=Object.defineProperty;var L=(t,e,n)=>e in t?P(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var m=(t,e,n)=>L(t,typeof e!="symbol"?e+"":e,n);import{r as u,j as f,c as l}from"./index-BN3Fa61G.js";const b=(t,e)=>e.some(n=>t instanceof n);let g,B;function v(){return g||(g=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function A(){return B||(B=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const D=new WeakMap,w=new WeakMap,h=new WeakMap;function S(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",a),t.removeEventListener("error",o)},a=()=>{n(d(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",a),t.addEventListener("error",o)});return h.set(e,t),e}function T(t){if(D.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",o),t.removeEventListener("abort",o)},a=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",a),t.addEventListener("error",o),t.addEventListener("abort",o)});D.set(t,e)}let x={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return D.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return d(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function R(t){x=t(x)}function O(t){return A().includes(t)?function(...e){return t.apply(C(this),e),d(this.request)}:function(...e){return d(t.apply(C(this),e))}}function V(t){return typeof t=="function"?O(t):(t instanceof IDBTransaction&&T(t),b(t,v())?new Proxy(t,x):t)}function d(t){if(t instanceof IDBRequest)return S(t);if(w.has(t))return w.get(t);const e=V(t);return e!==t&&(w.set(t,e),h.set(e,t)),e}const C=t=>h.get(t);function F(t,e,{blocked:n,upgrade:r,blocking:s,terminated:a}={}){const o=indexedDB.open(t,e),y=d(o);return r&&o.addEventListener("upgradeneeded",i=>{r(d(o.result),i.oldVersion,i.newVersion,d(o.transaction),i)}),n&&o.addEventListener("blocked",i=>n(i.oldVersion,i.newVersion,i)),y.then(i=>{a&&i.addEventListener("close",()=>a()),s&&i.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),y}const k=["get","getKey","getAll","getAllKeys","count"],W=["put","add","delete","clear"],I=new Map;function E(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(I.get(e))return I.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=W.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||k.includes(n)))return;const a=async function(o,...y){const i=this.transaction(o,s?"readwrite":"readonly");let c=i.store;return r&&(c=c.index(y.shift())),(await Promise.all([c[n](...y),s&&i.done]))[0]};return I.set(e,a),a}R(t=>({...t,get:(e,n,r)=>E(e,n)||t.get(e,n,r),has:(e,n)=>!!E(e,n)||t.has(e,n)}));const K=["continue","continuePrimaryKey","advance"],N={},p=new WeakMap,M=new WeakMap,H={get(t,e){if(!K.includes(e))return t[e];let n=N[e];return n||(n=N[e]=function(...r){p.set(this,M.get(this)[e](...r))}),n}};async function*$(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;e=e;const n=new Proxy(e,H);for(M.set(n,e),h.set(n,C(e));e;)yield n,e=await(p.get(n)||e.continue()),p.delete(n)}function j(t,e){return e===Symbol.asyncIterator&&b(t,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&b(t,[IDBIndex,IDBObjectStore])}R(t=>({...t,get(e,n,r){return j(e,n)?$:t.get(e,n,r)},has(e,n){return j(e,n)||t.has(e,n)}}));class _{constructor(e){m(this,"db",null);m(this,"options");this.options=e}async init(){const{dbName:e,version:n=1,storeNames:r}=this.options;this.db=await F(e,n,{upgrade(s){for(const a of r)s.objectStoreNames.contains(a)||s.createObjectStore(a)}})}ensureReady(){if(!this.db)throw new Error("IndexedDB is not ready yet. Call init() first.")}async getItem(e,n){return this.ensureReady(),await this.db.get(e,n)}async setItem(e,n,r){this.ensureReady(),await this.db.put(e,r,n)}async deleteItem(e,n){this.ensureReady(),await this.db.delete(e,n)}async clear(e){this.ensureReady(),await this.db.clear(e)}async getAll(e){return this.ensureReady(),await this.db.getAll(e)}async keys(e){return this.ensureReady(),await this.db.getAllKeys(e)}}const z=u.forwardRef(({className:t,...e},n)=>f.jsx("div",{ref:n,className:l("rounded-xl border bg-card text-card-foreground shadow",t),...e}));z.displayName="Card";const G=u.forwardRef(({className:t,...e},n)=>f.jsx("div",{ref:n,className:l("flex flex-col space-y-1.5 p-6",t),...e}));G.displayName="CardHeader";const J=u.forwardRef(({className:t,...e},n)=>f.jsx("div",{ref:n,className:l("font-semibold leading-none tracking-tight",t),...e}));J.displayName="CardTitle";const Q=u.forwardRef(({className:t,...e},n)=>f.jsx("div",{ref:n,className:l("text-sm text-muted-foreground",t),...e}));Q.displayName="CardDescription";const U=u.forwardRef(({className:t,...e},n)=>f.jsx("div",{ref:n,className:l("p-6 pt-0",t),...e}));U.displayName="CardContent";const X=u.forwardRef(({className:t,...e},n)=>f.jsx("div",{ref:n,className:l("flex items-center p-6 pt-0",t),...e}));X.displayName="CardFooter";export{z as C,_ as I};
