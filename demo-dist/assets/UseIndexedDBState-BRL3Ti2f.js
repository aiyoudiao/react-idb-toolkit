import{r as d,j as e,T as I,I as N,B as u,t as v}from"./index-CP7TzrjQ.js";import{u as C}from"./useIndexedDB-B0k12vPk.js";import{C as f}from"./card-Ath_W0LP.js";function j(o){const{storeName:t,key:a,defaultValue:r,onError:l=s=>console.error("IndexedDB Error:",s)}=o,{loading:x,getItem:h,setItem:m}=C({dbName:t,storeNames:[t]}),[i,c]=d.useState(()=>typeof r=="function"?r():r),[p,y]=d.useState(!0);d.useEffect(()=>{if(x)return;(async()=>{try{const n=await h(t,a);n!==void 0?c(n):r!==void 0&&await m(t,a,i)}catch(n){l(n)}finally{y(!1)}})()},[x]);const g=d.useCallback(async s=>{try{const n=s instanceof Function?s(i):s;c(n),await m(t,a,n)}catch(n){l(n),c(i)}},[t,a,m,i]);return[i,g,{loading:x||p,sync:async()=>{try{const s=await h(t,a);s!==void 0&&c(s)}catch(s){l(s)}}}]}const k=()=>{const[o,t,{loading:a}]=j({storeName:"demoStore",key:"storybook-key",defaultValue:"Hello IndexedDB"}),r=()=>{v({title:"Current Value",description:o,duration:3e3})};return e.jsxs(f,{className:"p-6 space-y-4 max-w-md w-full",children:[e.jsx(I,{}),e.jsx("h2",{className:"text-xl font-semibold",children:"Basic Usage"}),e.jsxs("p",{children:["Status: ",a?"Loading...":"Ready"]}),e.jsx(N,{value:o||"",onChange:l=>t(l.target.value),disabled:a}),e.jsx(f,{className:"p-4 overflow-auto break-words",children:o}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{onClick:r,children:"Show Current Value"}),e.jsx(u,{variant:"destructive",onClick:()=>t("Hello IndexedDB"),children:"Reset"})]})]})},w=()=>{const[o,t,{loading:a}]=j({storeName:"demoStore",key:"counter",defaultValue:0});return e.jsxs(f,{className:"p-6 text-center space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Persistent Counter"}),e.jsx("p",{className:"text-4xl font-bold",children:a?"...":o}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsx(u,{onClick:()=>t(r=>r+1),children:"Increment"}),e.jsx(u,{variant:"outline",onClick:()=>t(0),children:"Reset"})]})]})},b=()=>e.jsxs("div",{className:"h-screen flex flex-row justify-center items-center gap-4 text-gray-100",children:[e.jsx(k,{}),e.jsx(w,{})]});export{k as BasicUsage,w as CounterExample,b as default};
