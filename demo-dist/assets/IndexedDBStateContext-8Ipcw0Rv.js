import{r as e,j as p}from"./index-CN-moKEq.js";import{I as w}from"./card-BsEsqHi3.js";const d=e.createContext(null);function D({storeName:n,children:i}){const[t,l]=e.useState({}),r=e.useRef(null),[u,s]=e.useState(!0);e.useEffect(()=>{const c=new w({dbName:n,storeNames:[n]});c.init().then(()=>{r.current=c,s(!1)})},[n]);const a=e.useCallback(async c=>{if(r.current)return await r.current.getItem(n,c)},[r.current,n,u]),f=e.useCallback(async(c,g)=>{r.current&&await r.current.setItem(n,c,g)},[r.current,n,u]),I=e.useCallback(async c=>{r.current&&await r.current.deleteItem(n,c)},[r.current,n,u]),o=e.useCallback(async()=>{r.current&&await r.current.clear(n)},[r.current,n,u]),C=e.useCallback(async()=>{if(r.current)return await r.current.getAll(n)},[r.current,n,u]),b=e.useCallback(async()=>{if(r.current)return await r.current.keys(n)},[r.current,n,u]);return p.jsx(d.Provider,{value:{setItem:f,getItem:a,deleteItem:I,clear:o,getAll:C,keys:b,loading:u,states:t,setStates:l},children:i})}function E(n,i){const t=e.useContext(d),{states:l,setStates:r}=t||{};e.useEffect(()=>{t!=null&&t.loading||t==null||t.getItem(n).then(s=>{if(s!==void 0)r==null||r(a=>({...a,[n]:s}));else{if(i===void 0)return;r==null||r(a=>({...a,[n]:i})),t==null||t.setItem(n,i)}})},[t==null?void 0:t.loading,n]);const u=e.useCallback(s=>{t==null||t.setItem(n,s),r==null||r(a=>({...a,[n]:s}))},[t,n]);return[(l==null?void 0:l[n])??i,u,(t==null?void 0:t.loading)??!0]}export{D as I,E as u};
