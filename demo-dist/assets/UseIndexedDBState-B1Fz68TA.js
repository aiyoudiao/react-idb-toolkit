import{r as d,j as e,T as I,I as C,B as u,t as N}from"./index-CN-moKEq.js";import{u as v}from"./useIndexedDB-Cm_NeFkv.js";import{C as h}from"./card-BsEsqHi3.js";function j(o){const{storeName:t,key:a,defaultValue:r,onError:l=s=>console.error("IndexedDB Error:",s)}=o,{loading:x,getItem:f,setItem:m}=v({dbName:t,storeNames:[t]}),[i,c]=d.useState(()=>typeof r=="function"?r():r),[y,p]=d.useState(!0);d.useEffect(()=>{if(x)return;(async()=>{try{const n=await f(t,a);n!==void 0?c(n):r!==void 0&&await m(t,a,i)}catch(n){l(n)}finally{p(!1)}})()},[x]);const g=d.useCallback(async s=>{try{const n=s instanceof Function?s(i):s;c(n),await m(t,a,n)}catch(n){l(n),c(i)}},[t,a,m,i]);return[i,g,{loading:x||y,sync:async()=>{try{const s=await f(t,a);s!==void 0&&c(s)}catch(s){l(s)}}}]}const B=()=>{const[o,t,{loading:a}]=j({storeName:"demoStore",key:"storybook-key",defaultValue:"Hello IndexedDB"}),r=()=>{N({title:"Current Value",description:o,duration:3e3})};return e.jsxs(h,{className:"p-6 space-y-4 max-w-md w-full",children:[e.jsx(I,{}),e.jsx("h2",{className:"text-xl font-semibold",children:"Basic Usage"}),e.jsxs("p",{children:["Status: ",a?"Loading...":"Ready"]}),e.jsx(C,{value:o||"",onChange:l=>t(l.target.value),disabled:a}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{onClick:r,children:"Show Current Value"}),e.jsx(u,{variant:"destructive",onClick:()=>t("Hello IndexedDB"),children:"Reset"})]})]})},V=()=>{const[o,t,{loading:a}]=j({storeName:"demoStore",key:"counter",defaultValue:0});return e.jsxs(h,{className:"p-6 text-center space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Persistent Counter"}),e.jsx("p",{className:"text-4xl font-bold",children:a?"...":o}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsx(u,{onClick:()=>t(r=>r+1),children:"Increment"}),e.jsx(u,{variant:"outline",onClick:()=>t(0),children:"Reset"})]})]})},b=()=>e.jsxs("div",{className:"h-screen flex flex-row justify-center items-center gap-4 text-gray-100",children:[e.jsx(B,{}),e.jsx(V,{})]});export{B as BasicUsage,V as CounterExample,b as default};
