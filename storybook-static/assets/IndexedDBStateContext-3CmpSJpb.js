import{j as b}from"./jsx-runtime-ClZEHPQQ.js";import{r as n}from"./index-Cqyox1Tj.js";import{a as m}from"./input-q-Q2josW.js";const l=n.createContext(null);function w({storeName:e,children:s}){const[t,d]=n.useState({}),r=n.useRef(null),[u,i]=n.useState(!0);n.useEffect(()=>{const c=new m({dbName:e,storeNames:[e]});c.init().then(()=>{r.current=c,i(!1)})},[e]);const a=n.useCallback(async c=>{if(r.current)return await r.current.getItem(e,c)},[r.current,e,u]),o=n.useCallback(async(c,C)=>{r.current&&await r.current.setItem(e,c,C)},[r.current,e,u]),f=n.useCallback(async c=>{r.current&&await r.current.deleteItem(e,c)},[r.current,e,u]),p=n.useCallback(async()=>{r.current&&await r.current.clear(e)},[r.current,e,u]),I=n.useCallback(async()=>{if(r.current)return await r.current.getAll(e)},[r.current,e,u]),g=n.useCallback(async()=>{if(r.current)return await r.current.keys(e)},[r.current,e,u]);return b.jsx(l.Provider,{value:{setItem:o,getItem:a,deleteItem:f,clear:p,getAll:I,keys:g,loading:u,states:t,setStates:d},children:s})}function D(e,s){const t=n.useContext(l),{states:d,setStates:r}=t||{};n.useEffect(()=>{t!=null&&t.loading||t==null||t.getItem(e).then(i=>{if(i!==void 0)r==null||r(a=>({...a,[e]:i}));else{if(s===void 0)return;r==null||r(a=>({...a,[e]:s})),t==null||t.setItem(e,s)}})},[t==null?void 0:t.loading,e]);const u=n.useCallback(i=>{t==null||t.setItem(e,i),r==null||r(a=>({...a,[e]:i}))},[t,e]);return[(d==null?void 0:d[e])??s,u,(t==null?void 0:t.loading)??!0]}w.__docgenInfo={description:"",methods:[],displayName:"IndexedDBStateProvider",props:{storeName:{required:!0,tsType:{name:"string"},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};export{w as I,D as u};
